cmake_minimum_required(VERSION 3.16)

if(NOT WIN32)
  find_package(Threads REQUIRED)
endif()

file(GLOB hpp_files tests/*.hpp runner.hpp)

if(BUILD_LINK_SOEM)
  add_executable(example_soem soem.cpp ${hpp_files})
  target_link_libraries(example_soem autd3)
  target_link_libraries(example_soem link_soem)
  if(BUILD_GAIN_HOLO)
    target_link_libraries(example_soem gain_holo)
    target_compile_definitions(example_soem PRIVATE BUILD_GAIN_HOLO)
  endif()
  if(BUILD_MODULATION_AUDIO_FILE)
    target_link_libraries(example_soem modulation_audio_file)
    target_compile_definitions(example_soem PRIVATE BUILD_MODULATION_AUDIO_FILE)
    target_compile_definitions(example_soem PRIVATE AUTD3_RESOURCE_PATH="${PROJECT_SOURCE_DIR}/examples/resources")
  endif()
  if(WIN32)
    set_target_properties(example_soem PROPERTIES FOLDER "example")
  else()
    target_link_libraries(example_soem ${CMAKE_THREAD_LIBS_INIT})
  endif()
endif()

if(WIN32)
  if(BUILD_LINK_TWINCAT)
    add_executable(example_twincat twincat.cpp ${hpp_files})
    target_link_libraries(example_twincat autd3)
    target_link_libraries(example_twincat link_twincat)
    if(BUILD_GAIN_HOLO)
      target_link_libraries(example_twincat gain_holo)
      target_compile_definitions(example_twincat PRIVATE BUILD_GAIN_HOLO)
    endif()
    if(BUILD_MODULATION_AUDIO_FILE)
      target_link_libraries(example_twincat modulation_audio_file)
      target_compile_definitions(example_twincat PRIVATE BUILD_MODULATION_AUDIO_FILE)
      target_compile_definitions(example_twincat PRIVATE AUTD3_RESOURCE_PATH="${PROJECT_SOURCE_DIR}/examples/resources")
    endif()
    set_target_properties(example_twincat PROPERTIES FOLDER "example")
  endif()
endif()

if(BUILD_LINK_REMOTE_TWINCAT)
  add_executable(example_remote_twincat remote_twincat.cpp ${hpp_files})
  target_link_libraries(example_remote_twincat autd3)
  target_link_libraries(example_remote_twincat link_remote_twincat)
  target_link_libraries(example_remote_twincat ${CMAKE_THREAD_LIBS_INIT})
  if(BUILD_GAIN_HOLO)
    target_link_libraries(example_remote_twincat gain_holo)
    target_compile_definitions(example_remote_twincat PRIVATE BUILD_GAIN_HOLO)
  endif()
  if(BUILD_MODULATION_AUDIO_FILE)
    target_link_libraries(example_remote_twincat modulation_audio_file)
    target_compile_definitions(example_remote_twincat PRIVATE BUILD_MODULATION_AUDIO_FILE)
    target_compile_definitions(example_remote_twincat PRIVATE AUTD3_RESOURCE_PATH="${PROJECT_SOURCE_DIR}/examples/resources")
  endif()
  if(WIN32)
    set_target_properties(example_remote_twincat PROPERTIES FOLDER "example")
  endif()
endif()

if(BUILD_LINK_EMULATOR)
  add_executable(example_emulator emulator.cpp ${hpp_files})
  target_link_libraries(example_emulator autd3)
  target_link_libraries(example_emulator link_emulator)
  if(BUILD_GAIN_HOLO)
    target_link_libraries(example_emulator gain_holo)
    target_compile_definitions(example_emulator PRIVATE BUILD_GAIN_HOLO)
  endif()
  if(BUILD_MODULATION_AUDIO_FILE)
    target_link_libraries(example_emulator modulation_audio_file)
    target_compile_definitions(example_emulator PRIVATE BUILD_MODULATION_AUDIO_FILE)
    target_compile_definitions(example_emulator PRIVATE AUTD3_RESOURCE_PATH="${PROJECT_SOURCE_DIR}/examples/resources")
  endif()
  target_link_libraries(example_emulator ${CMAKE_THREAD_LIBS_INIT})
  if(WIN32)
    set_target_properties(example_emulator PROPERTIES FOLDER "example")
  endif()
endif()
